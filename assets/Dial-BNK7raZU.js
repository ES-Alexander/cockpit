import{c as Q,y as q,J as H,r as L,w as E,k as W,o as Z,b4 as ee,h as ae,l as k,m as r,n as d,s as c,x as D,O as T,v as l,b6 as B,G as te,t as oe,a$ as ne,I,N as O,Q as R,ag as A,aA as le,b5 as U,aw as ie,_ as se}from"./index-CHE0nPyS.js";const ue={class:"potentiometer-scale elevation-5"},re={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},de={class:"flex flex-col w-4 h-7 justify-between items-center"},p=0,$=100,S=300,ve=Q({__name:"Dial",props:{miniWidget:{}},setup(j){const o=q(),a=H(j).miniWidget,n=L(p),g=S/2,F=L(-g);let C;const s=L(!1),x=L(String(Math.round(n.value)||p));E(()=>o.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(o.showElementPropsDrawer(a.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const u=W(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.minValue)||p}),V=W(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.maxValue)||$}),v=e=>{let t;e==null||isNaN(Number(e))?t=u.value:t=Number(e),n.value=t;const i=V.value-u.value;F.value=(t-u.value)/i*S-g},z=()=>{var e;if(a.value.options.dataLakeVariable){C=le((e=a.value.options.dataLakeVariable)==null?void 0:e.name,i=>{v(i)});const t=o.getMiniWidgetLastValue(a.value.hash);v(t)}};E(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.name},e=>{e&&z()},{immediate:!0}),E(()=>[u.value,V.value],([e])=>{n.value=e,v(n.value)},{immediate:!0}),Z(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,o.updateElementOptions(a.value.hash,{layout:{minValue:p,maxValue:$,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable&&!a.value.options.dataLakeVariable.allowUserToChangeValue&&ee({...a.value.options.dataLakeVariable,allowUserToChangeValue:!0}),z()});const K=W(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),_=()=>{if(a.value.options.dataLakeVariable&&!o.editingMode){const e=Math.round(n.value);o.setMiniWidgetLastValue(a.value.hash,e),U(a.value.options.dataLakeVariable.name,e)}},P=e=>{e.preventDefault();const i=e.currentTarget.getBoundingClientRect(),w=i.left+i.width/2,M=i.top+i.height/2,b=f=>{const y=Math.atan2(f.clientX-w,M-f.clientY)*180/Math.PI;let m=Math.max(-g,Math.min(g,y));F.value=m;const J=V.value-u.value;n.value=(m+g)/S*J+u.value,a.value.options.dataLakeVariable&&_()},h=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",h)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",h)},X=()=>{n.value<V.value&&(v(n.value+1),_())},Y=()=>{n.value>u.value&&(v(n.value-1),_())},G=()=>{o.editingMode||(s.value=!0,x.value=String(Math.round(n.value)||p))},N=()=>{let e=parseFloat(x.value);if(isNaN(e)&&(e=Math.round(n.value)||p),e=Math.max(u.value,Math.min(e,V.value)),v(e),a.value.options.dataLakeVariable&&!o.editingMode){const t=Math.round(e);o.setMiniWidgetLastValue(a.value.hash,t),U(a.value.options.dataLakeVariable.name,t)}s.value=!1};return ae(()=>{a.value.options.dataLakeVariable&&C&&ie(a.value.options.dataLakeVariable.name,C)}),(e,t)=>{var i,w,M,b,h,f,y;return r(),k("div",{id:"dial",class:D(["flex items-center w-auto",((i=l(o).elementToShowOnDrawer)==null?void 0:i.hash)===l(a).hash&&l(o).editingMode?"bg-[#00000010] ":"border-0"]),style:T({justifyContent:(w=l(a).options.layout)==null?void 0:w.align}),onClick:t[2]||(t[2]=m=>l(o).editingMode&&l(o).showElementPropsDrawer(l(a).hash))},[d("div",{class:D(["flex flex-row",l(o).editingMode?"pointer-events-none":"pointer-events-auto"])},[d("div",{class:D(["potentiometer-container w-full",K.value]),onMousedown:P,onClick:t[0]||(t[0]=m=>s.value=!1)},[d("div",ue,[d("div",{class:"potentiometer-knob",style:T({transform:`rotate(${F.value}deg)`,background:((M=l(a).options.layout)==null?void 0:M.knobColor)||"#838383"})},[d("div",{class:"knob-notch",style:T({background:((b=l(a).options.layout)==null?void 0:b.notchColor)||"#222222"})},null,4)],4)])],34),((h=l(a).options.layout)==null?void 0:h.minValue)>=((f=l(a).options.layout)==null?void 0:f.maxValue)?(r(),k("p",re," Min value is larger than Max value ")):c("",!0)],2),(y=l(a).options.layout)!=null&&y.showValue?(r(),k("div",{key:0,class:"flex",onKeydown:B(N,["esc"])},[d("div",{class:D(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",s.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[s.value?c("",!0):(r(),k("div",{key:0,onClick:G},oe(Math.round(n.value)||0),1)),s.value?te((r(),k("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=m=>x.value=m),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:B(N,["enter"]),onBlur:N},null,544)),[[ne,x.value]]):c("",!0)],2),d("div",de,[s.value?c("",!0):(r(),I(A,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:X},{default:O(()=>t[3]||(t[3]=[R("mdi-plus")])),_:1,__:[3]})),s.value?c("",!0):(r(),I(A,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:Y},{default:O(()=>t[4]||(t[4]=[R("mdi-minus")])),_:1,__:[4]}))])],32)):c("",!0)],6)}}}),pe=se(ve,[["__scopeId","data-v-3d07b8e3"]]);export{pe as default};
