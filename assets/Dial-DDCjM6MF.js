import{c as H,y as Z,J as ee,r as D,w as E,k as W,o as ae,aM as te,h as oe,l as M,m as v,n as c,s as p,x as F,N as T,v as l,aO as B,G as ne,t as le,aG as ie,I as R,O as I,Q as A,a6 as K,a9 as se,aJ as ue,a1 as U,aN as j,_ as re}from"./index-DURbHWaM.js";const de={class:"potentiometer-scale elevation-5"},ve={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},ce={class:"flex flex-col w-4 h-7 justify-between items-center"},g=0,P=100,O=300,me=H({__name:"Dial",props:{miniWidget:{}},setup($){const o=Z(),a=ee($).miniWidget,n=D(g),m=O/2,C=D(-m);let V;const s=D(!1),w=D(String(Math.round(n.value)||g));E(()=>o.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(o.showElementPropsDrawer(a.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const u=W(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.minValue)||g}),b=W(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.maxValue)||P}),r=e=>{let t;e==null||isNaN(Number(e))?t=u.value:t=Number(e),n.value=t;const i=b.value-u.value;C.value=(t-u.value)/i*O-m},S=()=>{a.value.options.dataLakeVariable&&(V=se(a.value.options.dataLakeVariable.id,e=>{r(e)}),r(ue(a.value.options.dataLakeVariable.id))),r()};E(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&V&&U(t,V),e&&S()}),E(()=>[u.value,b.value],([e])=>{n.value=e,r(n.value)},{immediate:!0}),ae(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,o.updateElementOptions(a.value.hash,{layout:{minValue:g,maxValue:P,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable?(a.value.options.dataLakeVariable.allowUserToChangeValue||te({...a.value.options.dataLakeVariable,allowUserToChangeValue:!0}),S()):r(o.getMiniWidgetLastValue(a.value.hash))});const G=W(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),N=()=>{if(a.value.options.dataLakeVariable&&!o.editingMode){const e=Math.round(n.value);o.setMiniWidgetLastValue(a.value.hash,e),j(a.value.options.dataLakeVariable.id,e)}};let z=0;const J=e=>{e.preventDefault();const i=e.currentTarget.getBoundingClientRect(),y=i.left+i.width/2,L=i.top+i.height/2,h=k=>{const x=Math.atan2(k.clientX-y,L-k.clientY)*180/Math.PI;if(Math.abs(x-z)>m)return;let d=Math.max(-m,Math.min(m,x));C.value=d,z=d;const q=b.value-u.value;n.value=(d+m)/O*q+u.value,a.value.options.dataLakeVariable&&N()},f=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",f)},X=()=>{n.value<b.value&&(r(n.value+1),N())},Y=()=>{n.value>u.value&&(r(n.value-1),N())},Q=()=>{o.editingMode||(s.value=!0,w.value=String(Math.round(n.value)||g))},_=()=>{let e=parseFloat(w.value);if(isNaN(e)&&(e=Math.round(n.value)||g),e=Math.max(u.value,Math.min(e,b.value)),r(e),a.value.options.dataLakeVariable&&!o.editingMode){const t=Math.round(e);o.setMiniWidgetLastValue(a.value.hash,t),j(a.value.options.dataLakeVariable.id,t)}s.value=!1};return oe(()=>{a.value.options.dataLakeVariable&&V&&U(a.value.options.dataLakeVariable.id,V)}),(e,t)=>{var i,y,L,h,f,k,x;return v(),M("div",{id:"dial",class:F(["flex items-center w-auto",((i=l(o).elementToShowOnDrawer)==null?void 0:i.hash)===l(a).hash&&l(o).editingMode?"bg-[#00000010] ":"border-0"]),style:T({justifyContent:(y=l(a).options.layout)==null?void 0:y.align}),onClick:t[2]||(t[2]=d=>l(o).editingMode&&l(o).showElementPropsDrawer(l(a).hash))},[c("div",{class:F(["flex flex-row",l(o).editingMode?"pointer-events-none":"pointer-events-auto"])},[c("div",{class:F(["potentiometer-container w-full",G.value]),onMousedown:J,onClick:t[0]||(t[0]=d=>s.value=!1)},[c("div",de,[c("div",{class:"potentiometer-knob",style:T({transform:`rotate(${C.value}deg)`,background:((L=l(a).options.layout)==null?void 0:L.knobColor)||"#838383"})},[c("div",{class:"knob-notch",style:T({background:((h=l(a).options.layout)==null?void 0:h.notchColor)||"#222222"})},null,4)],4)])],34),((f=l(a).options.layout)==null?void 0:f.minValue)>=((k=l(a).options.layout)==null?void 0:k.maxValue)?(v(),M("p",ve," Min value is larger than Max value ")):p("",!0)],2),(x=l(a).options.layout)!=null&&x.showValue?(v(),M("div",{key:0,class:"flex",onKeydown:B(_,["esc"])},[c("div",{class:F(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",s.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[s.value?p("",!0):(v(),M("div",{key:0,onClick:Q},le(Math.round(n.value)||0),1)),s.value?ne((v(),M("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=d=>w.value=d),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:B(_,["enter"]),onBlur:_},null,544)),[[ie,w.value]]):p("",!0)],2),c("div",ce,[s.value?p("",!0):(v(),R(K,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:X},{default:I(()=>t[3]||(t[3]=[A("mdi-plus")])),_:1,__:[3]})),s.value?p("",!0):(v(),R(K,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:Y},{default:I(()=>t[4]||(t[4]=[A("mdi-minus")])),_:1,__:[4]}))])],32)):p("",!0)],6)}}}),Ve=re(me,[["__scopeId","data-v-2620cd04"]]);export{Ve as default};
